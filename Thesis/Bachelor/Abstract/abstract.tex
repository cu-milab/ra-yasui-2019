\documentclass{jsarticle}
\usepackage{abst, epsf,graphicx, tabularx, ascmac}
%\usepackage{comment}

\newcommand{\bd}[1]{\mbox{\boldmath$#1$}}
\newcommand{\mysubsec}[1]{\noindent {\bf #1} \ \ }
\newcommand{\down}[1]{\raisebox{-0.0mm}{{\scriptsize #1}}}

\makeatletter
\newcommand{\figcaption}[1]{\def\@captype{figure}\caption{#1}}
\newcommand{\tblcaption}[1]{\def\@captype{table}\caption{#1}}
\makeatother


\title{変形ARマーカの認識及び姿勢推定}
\prof{山内 悠嗣}
\name{ER17076 安井理}

\begin{document}
\maketitle

%-------------------------------------------------------------------------
\sec{はじめに}
現在QRコードやARマーカなどの2次元コードは，製造での工程管理，製品ピッキング棚卸やロボット認識機能等の広い分野で利用されている．
2次元コードの特徴として，シンボルと呼ばれる特殊なパターンにより，どの視点からでも背景模様の影響を受けない，高精度な検出が可能である．
さらに2次元コードの大きさを事前に定義することにより，張り付けられている物体の位置，姿勢を推定することが可能である．しかし，2次元コードを使用する前提条件として，平面に張り付ける事が挙げられる，曲面や角に張られた2次元コードは歪みにより見え方の変化を引き起こし，認識精度が低下する問題を抱えている．

そこで，本研究では，Augument Autoencoder(AAE)[1]を用いた変形ARマーカの平面化及び姿勢推定する．変形したARマーカの画像をAAEに入力し，歪みを取り除いた平面状のARマーカの表示，歪んだARマーカの姿勢推定を行う．


\sec{AAEを用いた姿勢推定}
図\ref{flow}は，提案手法による変形ARマーカの姿勢推定の流れを示す．本研究ではARマーカの姿勢をAugumented Autencoder（AAE）を学習することによって歪みを持つARマーカを，歪みを解消した平面状のARマーカが出力される．その後，姿勢情報を持つARマーカの画像を学習済みのAAEに通す，encoderから潜在変数を取得し蓄積しておく．推定したいARマーカをAAEに通し，得られた潜在変数と蓄積された潜在変数をk近傍法を用いることで，最も近い姿勢情報をもつARマーカの画像を姿勢として推定する．

\begin{figure}[ht]
\vspace{-5zh}
\setlength{\epsfxsize}{3cm}
\centerline{\epsfbox{./eps/作図中.eps}}
\vspace{8zh}
\caption{提案手法の流れ}
\label{flow}
\vspace{-1.0zh}
\end{figure}

%---------------------------------------------------------------------------------------
\subsec{Augumented Autoencoder}
AAEの学習の流れを図\ref{BB}に示す．学習したい元画像となる平面状のARマーカの貼られた円柱の画像（a）を正解画像として用意し，
元画像と同じ姿勢のARマーカを円柱に沿うように貼り付けた画像（b）を入力としてAutencoderにかける．出力（c）は（a）と誤差を取り（a）を再現するように学習を行う．
これによりAAEに変形ARマーカを入力したときに，同じ姿勢の平面状のARマーカを出力可能になる．

\begin{figure}[ht]
\vspace{-7zh}
\setlength{\epsfxsize}{7.5cm}
\centerline{\epsfbox{./eps/学習の流れ.eps}}
\vspace{5zh}
\caption{AAEの学習}
\label{BB}
\vspace{-1.0zh}
\end{figure}




%---------------------------------------------------------------------------------
\subsec{AAEによる姿勢推定}
推定までの全体的な流れを図\ref{GG}に示す．
学習済みのAAEに姿勢情報を持つターゲット画像を入力する．
encoderから得られる姿勢情報を含む潜在変数を蓄積する．
encoderに入力し得られた潜在変数と蓄積された潜在変数との，
コサイン類似度式(\ref{cos})を求めることによって最も近い値の潜在変数の姿勢情報を物体姿勢として決定する．
%\footnotesize{
\begin{eqnarray}
\label{cos}
cos_n=\frac{z_n z_{test}}{||z_n|| ||z_{test}||}
%=\frac{x_1x'_1+\cdots+x_n x'_n}{\sqrt{x^2_1+\cdots+x'^2_n}\sqrt{x^2_1+\cdots+x'^2_n}}
\end{eqnarray}


\begin{figure}[ht]
\vspace{-5zh}
\setlength{\epsfxsize}{7.5cm}
\centerline{\epsfbox{./eps/姿勢推定.eps}}
\vspace{5zh}
\caption{AAEによる姿勢推定}
\label{GG}
\vspace{-1.0zh}
\end{figure}

%------------------------------------------------------------------------------


\sec{評価実験}


提案手法の有効性を確認するために評価実験を行う．
評価方法としてgazeboのシミュレーション空間上にARマーカを円柱に張り付けたモデルを表示し，撮影を行う．
ARマーカのモデルは，半径20,30,40,50[mm]の円柱を各モデル姿勢20枚ずつ用意する．
撮影されたモデル画像をSSDによって検出し，その際に得られたバウンディングボックスの画像を使用する．
バウンディングボックスの画像を入力として提案手法により姿勢推定を行う．評価用画像のモデル姿勢と提案手法により推定された姿勢の[roll,pitch,yaw]を比較し誤差を評価する．

評価結果を表\ref{hyouka}に示す．結果は10枚の姿勢画像の[roll,pitch,yaw]のそれぞれの誤差の平均を取った値を表に示す．誤差は，各半径どれも2°前後となっており姿勢の推定を行うことができているといえる．







\begin{table}[h]
        \vspace{-1.8zh}
          \begin{center}
            \caption{AAEを用いた姿勢推定の誤差}
            \label{hyouka}
            \begin{tabular}{l|c|c|c} \hline
              円柱半径[mm]   & roll& pitch & yaw \\ \hline
 20  & 1° & 2° & 0° \\ \hline
              30  & 0° & 0° & 2° \\ \hline
              40  & 1° & 1° & 1° \\ \hline
              50  & 0°& 2° & 1° \\ \hline
              \end{tabular}
          \end{center}
        \vspace{-1.0zh}
\end{table}





\sec{おわりに}
本研究では，変形ARマーカの認識及び姿勢推定を提案し，機械学習によってARマーカの座標位置，姿勢を推定できる事を確認した．今後は，提案手法のよるリアルタイムでの三次元位置・姿勢の推定を研究を行う予定である．

\markboth{参考文献}{}     %% BibTeX を使う
%\bibliographystyle{jalpha}
%\newcommand{\noop}[1]{}
%\bibliographystyle{jabbrv}
%\bibliography{ref}

\begin{thebibliography}{1}
%{\scriptsize 
%\bibitem{hog+motion}
%Wei Liu，Dragomir Anguelov， Dumitru Erhan，Christian Szegedy，Scott Reed，Cheng-Yang Fu， Alexander C. Berg : ``SSD: Single Shot MultiBox Detector'', Proc. of ECCV, 2016.}

{\scriptsize 
\bibitem{pixel}
Martin Sundermeyer {\em et al．}: ``Implicit 3D Orientation Learning for 6D Object Detection from RGB Images'', 
Proc．of ECCV， 2016．}

\end{thebibliography}
\end{document}