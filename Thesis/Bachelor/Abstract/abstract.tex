\documentclass{jsarticle}
\usepackage{abst, epsf,graphicx, tabularx, ascmac}
%\usepackage{comment}

\newcommand{\bd}[1]{\mbox{\boldmath$#1$}}
\newcommand{\mysubsec}[1]{\noindent {\bf #1} \ \ }
\newcommand{\down}[1]{\raisebox{-0.0mm}{{\scriptsize #1}}}

\makeatletter
\newcommand{\figcaption}[1]{\def\@captype{figure}\caption{#1}}
\newcommand{\tblcaption}[1]{\def\@captype{table}\caption{#1}}
\makeatother


\title{変形ARマーカの認識及び姿勢推定}
\prof{山内 悠嗣}
\name{ER17076 安井理}

\begin{document}
\maketitle

%-------------------------------------------------------------------------
\sec{はじめに}
現在QRコードやARマーカなどの2次元コードは，製造での工程管理，製品ピッキング棚卸やロボット認識機能等の広い分野で利用されている．
2次元コードの特徴として，シンボルと呼ばれる特殊なパターンにより，どの視点からでも背景模様の影響を受けない，高精度な検出が可能である．
さらに2次元コードの大きさを事前に定義することにより，張り付けられている物体の位置，姿勢を推定することが可能である．しかし，2次元コードを使用する前提条件として，平面に張り付ける事が挙げられる，曲面や角に張られた2次元コードは歪みにより見え方の変化を引き起こし，認識精度が低下する問題を抱えている．

そこで，本研究では，Augument Autoencoder(AAE)[1]を用いた変形ARマーカの平面化及び姿勢推定を提案する．
変形したARマーカの画像をAAEに入力し，歪みを取り除いた平面状のARマーカ画像を生成する．そして，変形ARマーカの姿勢推定を行う．


\sec{AAEを用いた姿勢推定}
図\ref{flow}に，提案手法による変形ARマーカの姿勢推定の流れを示す．本研究ではAAEに変形ARマーカ画像を入力し，平面ARマーカ画像を出力するように学習する．姿勢推定では事前に学習したAAEに各姿勢ごとのARマーカ画像のデータベースを入力し，潜在変数を蓄積する．そして，検出されたARマーカを学習済みのAAEに入力し，潜在変数を得る．変形ARマーカの潜在変数とデータベースの潜在変数の類似度を計算し，類似度からARマーカの姿勢を推定する．

\begin{figure}[ht]
\vspace{-5zh}
\setlength{\epsfxsize}{3cm}
\centerline{\epsfbox{./eps/作図中.eps}}
\vspace{8zh}
\caption{提案手法の流れ}
\label{flow}
\vspace{-1.0zh}
\end{figure}

%---------------------------------------------------------------------------------------
\subsec{Augumented Autoencoder}
AAEは，変化の加わった物体の画像を，変化を取り除いた画像として生成するように学習するAutencoderである．
AAEの学習の流れを図\ref{BB}に示す．学習したい元画像となる平面状のARマーカの貼られた円柱の画像（a）を正解画像として用意し，
元画像と同じ姿勢のARマーカを円柱に沿うように貼り付けた画像（b）を入力としてAutencoderにかける．出力（c）は（a）と誤差を取り（a）を再現するように学習を行う．
これによりAAEに変形ARマーカを入力したときに，同じ姿勢の平面状のARマーカを出力可能になる．

\begin{figure}[ht]
\vspace{-7zh}
\setlength{\epsfxsize}{7.5cm}
\centerline{\epsfbox{./eps/学習の流れ.eps}}
\vspace{5zh}
\caption{AAEの学習}
\label{BB}
\vspace{-1.0zh}
\end{figure}




%---------------------------------------------------------------------------------
\subsec{AAEによる姿勢推定}
推定までの全体的な流れを図\ref{GG}に示す．
推定は，ターゲット画像と姿勢情報を持つデータセットの潜在変数の類似度にって行われる．
学習済みのAAEに姿勢情報を持つデータセット画像roll360度，picth(-35∼35)度，yaw（-15∼15）度それぞれ１度刻み
の画像792,360枚を入力する．
encoderから得られる姿勢情報を含む潜在変数$z_n$を蓄積する．
encoderに入力し得られた潜在変数$z_{test}$と蓄積された潜在変数との
コサイン類似度を式(1)により計算する．そして，最も近い値の潜在変数の姿勢情報を物体姿勢として決定する．
%\footnotesize{
\begin{eqnarray}
\label{cos}
cos_n=\frac{z_n z_{test}}{||z_n|| ||z_{test}||}
%=\frac{x_1x'_1+\cdots+x_n x'_n}{\sqrt{x^2_1+\cdots+x'^2_n}\sqrt{x^2_1+\cdots+x'^2_n}}
\end{eqnarray}


\begin{figure}[ht]
\vspace{-5zh}
\setlength{\epsfxsize}{7.5cm}
\centerline{\epsfbox{./eps/姿勢推定.eps}}
\vspace{5zh}
\caption{AAEによる姿勢推定}
\label{GG}
\vspace{-1.0zh}
\end{figure}

%------------------------------------------------------------------------------


\sec{評価実験}


提案手法の有効性を確認するために評価実験を行う．
評価方法としてgazeboのシミュレーション空間上にARマーカを円柱に張り付けたモデルを表示し，撮影を行う．
ARマーカのモデルは，半径20,30,40,50[mm]の円柱を各モデル姿勢100枚ずつ用意する．
撮影されたモデル画像をSSDによって検出し，その際に得られたバウンディングボックスの画像を128$\times$128にリサイズし，使用する．
バウンディングボックスの画像を入力として提案手法により姿勢推定を行う．評価用画像のモデル姿勢と提案手法により推定された姿勢の[roll,pitch,yaw]を比較し平均平方二乗誤差(RMSE)により評価する．

評価結果を表\ref{hyouka}に示す．誤差は，各半径どれも2°前後となっており姿勢の推定を行うことができているといえる．

%と平均絶対誤差（MAE）






\begin{table}[h]
        \vspace{-1.8zh}
          \begin{center}
            \caption{RMSE}
            \label{hyouka}
            \begin{tabular}{l|c|c|c} \hline
              円柱半径[mm]   & roll& pitch & yaw \\ \hline
 20  & 1° & 2° & 0° \\ \hline
              30  & 0° & 0° & 2° \\ \hline
              40  & 1° & 1° & 1° \\ \hline
              50  & 0°& 2° & 1° \\ \hline
              \end{tabular}
          \end{center}
        \vspace{-1.0zh}
\end{table}

%\begin{table}[h]
        %\vspace{-1.8zh}
         % \begin{center}
       %     \caption{MAE}
       %     \label{hyouka2}
     %       \begin{tabular}{l|c|c|c} \hline
   %           円柱半径[mm]   & roll& pitch & yaw \\ \hline
 %20  & 2.43° & 2.2° & 2.5° \\ \hline
         %     30  & 0° & 1° & 2.2° \\ \hline
       %       40  & 1° & 1° & 1° \\ \hline
     %         50  & 0°& 2° & 1° \\ \hline
   %           \end{tabular}
 %         \end{center}
 %       \vspace{-1.0zh}
%\end{table}





\sec{おわりに}
本研究では，変形ARマーカの認識及び姿勢推定を提案し，機械学習によってARマーカの座標位置，姿勢を推定できる事を確認した．今後は，提案手法のよるリアルタイムでの三次元位置・姿勢の推定を研究を行う予定である．

\markboth{参考文献}{}     %% BibTeX を使う
%\bibliographystyle{jalpha}
%\newcommand{\noop}[1]{}
%\bibliographystyle{jabbrv}
%\bibliography{ref}

\begin{thebibliography}{1}
%{\scriptsize 
%\bibitem{hog+motion}
%Wei Liu，Dragomir Anguelov， Dumitru Erhan，Christian Szegedy，Scott Reed，Cheng-Yang Fu， Alexander C. Berg : ``SSD: Single Shot MultiBox Detector'', Proc. of ECCV, 2016.}

{\scriptsize 
\bibitem{pixel}
Martin Sundermeyer {\em et al．}: ``Implicit 3D Orientation Learning for 6D Object Detection from RGB Images'', 
Proc．of ECCV， 2016．}

\end{thebibliography}
\end{document}